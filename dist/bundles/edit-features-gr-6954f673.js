define("spectre-canjs@1.0.1#util/string/string",["exports","can-util/js/string/string"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.makeSentenceCase=function(e){return e=String(e),r.default.capitalize(String.prototype.trim.call(e.split("_").join(" ").toLowerCase().replace(/ +/g," ")))};var r=function(e){return e&&e.__esModule?e:{default:e}}(t)}),define("can-arcgis@0.3.0#components/identify/util/identifyMapImage",["exports","esri-loader","can-util/js/get/get","can-util/js/assign/assign","spectre-canjs/util/string/string"],function(e,t,r,n,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r){return e.results?e.results.map(function(e){var n=(0,s.default)(t,r.id+"."+e.layerId)||{};return e.feature.popupTemplate=(0,l.default)({title:e.layerName,content:[{type:"fields",fieldInfos:Object.keys(e.feature.attributes).map(function(e){return{fieldName:e,label:(0,i.makeSentenceCase)(e),visible:!0}})}]},n.serialize?n.serialize():n),e.feature}):[]}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,r,n){return new Promise(function(i){(0,t.loadModules)(["esri/tasks/support/IdentifyParameters","esri/tasks/IdentifyTask"]).then(function(t){var a=o(t,2),l=a[0],f=a[1],c=(0,s.default)(n.layerInfos,r.id+".include"),d=(0,s.default)(n.layerInfos,r.id+".exclude"),y=new l({layerIds:r.sublayers.filter(function(e){return(!c||!c.length||-1!==c.indexOf(e.id))&&!(d&&d.length&&d.indexOf(e.id)>-1)&&e.visible}).map(function(e){return e.id}),layerOption:"visible",returnGeometry:!0,spatialReference:e.mapPoint.spatialReference,tolerance:15,geometry:e.mapPoint,height:n.view.height,width:n.view.width,mapExtent:n.view.extent});new f({url:r.url}).execute(y).then(function(e){var t=u(e,n.popupTemplates,r);i(t)})})})};var s=a(r),l=a(n),o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var u,s=e[Symbol.iterator]();!(n=(u=s.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),define("can-arcgis@0.3.0#components/identify/identify",["exports","can-define/map/map","./util/identifyMapImage","can-util/js/dev/dev","esri-loader"],function(e,t,r,n,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.IDENTIFY_METHODS=void 0;var u=a(t),s=a(r),l=a(n),o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var u,s=e[Symbol.iterator]();!(n=(u=s.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=void 0;(0,i.loadModules)(["esri/geometry/geometryEngine"]).then(function(e){var t=o(e,1);f=t[0]});var c=e.IDENTIFY_METHODS={"esri.layers.MapImageLayer":s.default,"esri.layers.FeatureLayer":function(e,t,r){return new Promise(function(t){r.view.hitTest(e).then(function(e){t(e.results.filter(function(e){return"esri.layers.VectorTileLayer"!==e.graphic.layer.declaredClass}).map(function(e){return e.graphic}))})})}};e.default=u.default.extend({clickHandle:"*",layerInfos:u.default,view:{type:"*",set:function(e){return this.clickHandle&&this.clickHandle.remove(),e&&(this.clickHandle=e.on("click",this.identify.bind(this))),e}},identify:function(e){var t=this;e.stopPropagation(),this.view.popup.features=[];var r=[],n=this.view.map.allLayers;return n.toArray().sort(function(e,t){if("esri.layers.FeatureLayer"===e.declaredClass)return-1;var r=n.indexOf(e);return n.indexOf(t)-r}).forEach(function(n){if(n.visible)if(c.hasOwnProperty(n.declaredClass)){var i=new Promise(function(r){var i=!1;c[n.declaredClass](e,n,t).then(function(e){i&&l.default.warn("identify: promise was already resolved"),i=!0,r(e)}),setTimeout(function(){i||(l.default.warn("identify: promise timeout exceeded"),r([]))},5e3)});r.push(i)}else l.default.warn("identify: no identify function registered for type "+n.declaredClass)}),new Promise(function(n){Promise.all(r).then(function(r){var i=r.reduce(function(e,t){return e.concat(t)},[]);i.sort(function(t,r){var n=[t,r].map(function(e){return e.geometry.extent?e.geometry.extent.center:e.geometry}),i=n.map(function(t,r){return f.distance(e.mapPoint,n[r],"feet")}),a=i[0]-i[1];if(Math.round(100*a)/100==0){if(t.layer&&"esri.layers.FeatureLayer"===t.layer.declaredClass)return-1;if(r.layer&&"esri.layers.FeatureLayer"===r.layer.declaredClass)return 1}return a}),i.length&&t.view.popup.open({selectedFeatureIndex:0,features:i,updateLocationEnabled:!0}),n(i)})})}})});
//# sourceMappingURL=edit-features-gr-6954f673.js.map